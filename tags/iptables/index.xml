<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>kingjcy Blog</title>
    <link>http://kingjcy.github.io/tags/iptables/index.xml</link>
    <description>Recent content on kingjcy Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>Copyright (c) 2016. All rights reserved.</copyright>
    <atom:link href="http://kingjcy.github.io/tags/iptables/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>iptables tutorial</title>
      <link>http://kingjcy.github.io/blog/2016/12/02/iptables-tutorial/</link>
      <pubDate>Fri, 02 Dec 2016 17:13:49 +0800</pubDate>
      
      <guid>http://kingjcy.github.io/blog/2016/12/02/iptables-tutorial/</guid>
      <description>&lt;p&gt;防火墙是通过审查经过的每一个数据包，判断它是否有相匹配的过滤规则，根据规则的先后顺序进行一一比较，直到满足其中的一条规则为止，然后依据控制机制做出相应的动作。如果都不满足，则将数据包丢弃，从而保护网络的安全。目前防火墙有两种机制：一个是阻止传输流通过，一个是允许传输流通过。就是我们所说的过滤式的防火墙，还有就是代理服务器。&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h2 id=&#34;iptables基本概念&#34;&gt;iptables基本概念&lt;/h2&gt;

&lt;p&gt;规则（rules）：预定义条件，一般类似于“如果数据包头符合这样的条件，就这样处理这个数据包。”&lt;/p&gt;

&lt;p&gt;链（chains）：是数据包传播的路径，每一条链其实就是众多规则中的一个检查清单，每一条链中可以有一条或数条规则。&lt;/p&gt;

&lt;p&gt;表（tables）：提供特定的功能，iptables内置了4个表，即filter表、nat表、mangle表和raw表，分别用于实现包过滤，网络地址转换、包重构(修改)和数据跟踪处理。&lt;/p&gt;

&lt;p&gt;显而易见，数据包在链上传输，通过表中不同规则的检查，决定怎么处理这些数据包，比如放行（accept）、拒绝（reject）和丢弃（drop）等&lt;/p&gt;

&lt;h2 id=&#34;iptables命令&#34;&gt;iptables命令&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;iptables [-t table] 命令 [chain] [rules] [-j target]
&lt;/code&gt;&lt;/pre&gt;

&lt;ol&gt;
&lt;li&gt;table——指定表，也就是上面指iptables内的四张表。&lt;/li&gt;
&lt;li&gt;命令——对链的操作命令&lt;/li&gt;
&lt;li&gt;-P或–policy &amp;lt;链名&amp;gt; 定义默认策略&lt;/li&gt;
&lt;li&gt;-L或–list &amp;lt;链名&amp;gt; 查看iptables规则列表&lt;/li&gt;
&lt;li&gt;-A或—append &amp;lt;链名&amp;gt; 在规则列表的最后增加1条规则&lt;/li&gt;
&lt;li&gt;-I或–insert &amp;lt;链名&amp;gt; 在指定的位置插入1条规则&lt;/li&gt;
&lt;li&gt;-D或–delete &amp;lt;链名&amp;gt; 从规则列表中删除1条规则&lt;/li&gt;
&lt;li&gt;-R或–replace &amp;lt;链名&amp;gt; 替换规则列表中的某条规则&lt;/li&gt;
&lt;li&gt;-F或–flush &amp;lt;链名&amp;gt; 删除表中所有规则&lt;/li&gt;
&lt;li&gt;-Z或–zero &amp;lt;链名&amp;gt; 将表中数据包计数器和流量计数器归零&lt;/li&gt;
&lt;li&gt;chain——链名&lt;/li&gt;
&lt;li&gt;INPUT&lt;/li&gt;
&lt;li&gt;OUTPUT&lt;/li&gt;
&lt;li&gt;FORWORD&lt;/li&gt;
&lt;li&gt;PREROUTING&lt;/li&gt;

&lt;li&gt;&lt;p&gt;POSTROUTING&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;rules——规则&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;-i或–in-interface &amp;lt;网络接口名&amp;gt; 指定数据包从哪个网络接口进入，如ppp0、eth0和eth1等&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;-o或–out-interface &amp;lt;网络接口名&amp;gt; 指定数据包从哪块网络接口输出，如ppp0、eth0和eth1等&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;上面两个支持&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;-p或—proto协议类型 &amp;lt; 协议类型&amp;gt; 指定数据包匹配的协议，如TCP、UDP和ICMP等

&lt;ul&gt;
&lt;li&gt;TCP&lt;/li&gt;
&lt;li&gt;UDP&lt;/li&gt;
&lt;li&gt;ICMP&lt;/li&gt;
&lt;li&gt;protocol name  from /etc/protocol&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;-s或–source &amp;lt;源地址或子网&amp;gt; 指定数据包匹配的源地址&lt;/li&gt;
&lt;li&gt;–sport &amp;lt;源端口号&amp;gt; 指定数据包匹配的源端口号，可以使用“起始端口号:结束端口号”的格式指定一个范围的端口&lt;/li&gt;
&lt;li&gt;-d或–destination &amp;lt;目标地址或子网&amp;gt; 指定数据包匹配的目标地址&lt;/li&gt;
&lt;li&gt;–dport目标端口号 指定数据包匹配的目标端口号，可以使用“起始端口号:结束端口号”的格式指定一个范围的端口&lt;/li&gt;
&lt;li&gt;target——动作如何进行&lt;/li&gt;
&lt;li&gt;ACCEPT 接受数据包&lt;/li&gt;
&lt;li&gt;DROP 丢弃数据包&lt;/li&gt;
&lt;li&gt;REDIRECT 与DROP基本一样，区别在于它除了阻塞包之外， 还向发送者返回错误信息。&lt;/li&gt;
&lt;li&gt;SNAT 源地址转换，即改变数据包的源地址&lt;/li&gt;
&lt;li&gt;DNAT 目标地址转换，即改变数据包的目的地址&lt;/li&gt;
&lt;li&gt;MASQUERADE IP伪装，即是常说的NAT技术，MASQUERADE只能用于ADSL等拨号上网的IP伪装，也就是主机的IP是由ISP分配动态的；如果主机的IP地址是静态固定的，就要使用SNAT&lt;/li&gt;
&lt;li&gt;LOG 日志功能，将符合规则的数据包的相关信息记录在日志中，以便管理员的分析和排错&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
  </channel>
</rss>